//! Speech KITT
//! version : 0.3.0
//! author  : Tal Ater @TalAter
//! license : MIT
//! https://github.com/TalAter/SpeechKITT
(function(a){"use strict";var b,c,d,e,f,g,h=this,i=0,j=!1,k="Activate Voice Control",l="What can I help you with?",m=[],n=[],o=function(){return g!==a},p=function(){e&&o()&&(f?f.href=e:(f=document.createElement("link"),f.rel="stylesheet",f.href=e,f.id="skitt-style-sheet",document.body.appendChild(f)))},q=function(){if(o()){var a=document.getElementById("skitt-listening-text__samples");if(m.length){if(!a){var b=document.getElementById("skitt-listening-text__instructions");a=document.createElement("span"),a.id="skitt-listening-text__samples",b.parentNode.insertBefore(a,b.nextSibling)}a.innerText=m.join(". ")+"."}else a&&a.parentNode.removeChild(a)}},r=function(){g=document.createElement("div"),g.id="skitt-ui",g.innerHTML='<a id="skitt-toggle-button">&nbsp;</a><label for="skitt-toggle-button" id="skitt-toggle-button__label">'+k+'</label><div id="skitt-listening-box"><div id="skitt-listening-text"><span id="skitt-listening-text__instructions">'+l+"</span></div></div>",g.style.display="none",document.body.appendChild(g),q(),p(),document.getElementById("skitt-toggle-button").addEventListener("click",function(){h.SpeechKITT.toggleRecognition()})},s=function(){o()&&(g.classList.remove("skitt-ui--not-listening"),g.classList.add("skitt-ui--listening"))},t=function(){o()&&(g.classList.add("skitt-ui--not-listening"),g.classList.remove("skitt-ui--listening"))},u=function(){j||(j=!0,s())},v=function(){j&&(j=!1,t())},w=function(a,b){o()&&(document.getElementById(b).innerHTML=a)},x=function(a){Array.isArray(a)&&(a=a[0]),h.SpeechKITT.setRecognizedSentence(a)},y=function(){var a=new Date;a.setTime(a.getTime()+6e4*i),document.cookie="skittremember=1; expires="+a.toUTCString()+"; path=/"},z=function(){document.cookie="skittremember=1; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/"},A=function(){return-1!==document.cookie.indexOf("skittremember")},B=function(a,b){if("function"!=typeof a)throw new TypeError(b)};h.SpeechKITT={setStartCommand:function(a,b){a=h[a]||a,B(a,"invalid callback function"),b=b||this,c={callback:a,context:b}},setAbortCommand:function(a,b){a=h[a]||a,B(a,"invalid callback function"),b=b||this,d={callback:a,context:b}},startRecognition:function(){if(!c)throw new TypeError("cannot start recognition. Start command not defined");i&&y(),c.callback.apply(c.context),u()},abortRecognition:function(){if(!d)throw new TypeError("cannot abort recognition. Abort command not defined");z(),d.callback.apply(d.context),v()},toggleRecognition:function(){j?this.abortRecognition():this.startRecognition()},onStart:function(){h.clearTimeout(b),u()},onEnd:function(){b=setTimeout(v,100)},setStylesheet:function(a){e=a,p()},render:function(){o()||r(),A()&&!this.isListening()&&this.startRecognition(),this.isListening()?s():t()},vroom:function(){this.render()},hide:function(){if(!o())throw new TypeError("cannot hide interface. Must be rendered first");g.classList.add("skitt-ui--hidden")},show:function(){if(!o())throw new TypeError("cannot show interface. Must be rendered first");g.classList.remove("skitt-ui--hidden")},isListening:function(){return j},setToggleLabelText:function(a){k=a,w(a,"skitt-toggle-button__label")},setInstructionsText:function(a){l=a,w(a,"skitt-listening-text__instructions")},setSampleCommands:function(a){Array.isArray(a)||(a=[]),m=a,q()},rememberStatus:function(a){if("number"!=typeof a||0>a)throw new TypeError("rememberStatus() only accepts positive integers");i=a},getLastRecognizedSentence:function(){return 0===n.length?a:n[n.length-1]},setRecognizedSentence:function(a){"string"==typeof a&&n.push(a)},annyang:function(){this.setStartCommand(annyang.start),this.setAbortCommand(annyang.abort),annyang.addCallback("start",this.onStart),annyang.addCallback("end",this.onEnd),annyang.addCallback("resultMatch",x),annyang.addCallback("resultNoMatch",x)}}}).call(this);